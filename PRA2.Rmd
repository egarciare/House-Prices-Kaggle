---
title: "PRA2-Tipologia i cicle de vida de les dades - HousePrices"
author: "Damián & Eusebi"
date: "26/5/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r Libraries, message=FALSE, warning=FALSE, echo=FALSE}

library(readr)
library(dplyr)
library(tidyverse)
library(class)
library(purrr)
library(cluster)
library(ggplot2)
library(arules)
library(tseries)
library(knitr)
library(caret)
library(moments)
library(reshape2)
library(ggfortify)
library(viridis)
library(discretization)
library(fpc)
if(!require(ggplot2)){
    install.packages('ggplot2', repos='http://cran.us.r-project.org')
    library(ggplot2)
}
if(!require(nortest)){
    install.packages('nortest', repos='http://cran.us.r-project.org')
    library(nortest)
}


##library(devtools)
```

S'assignen a variables el dataset de train i el de test
```{r cars}
#summary(cars)
train <- read_csv('HousePrices/train.csv' )
test <- read_csv("HousePrices/test.csv")
```

1-Exploració del dataset
========================

```{r pressure, echo=FALSE}
names(train)
```

```{r pressure, echo=FALSE}
summary(train)
```

```{r pressure, echo=FALSE}
str(train)
```


DESCRIPCIó
===========
Aquest dataset conté les característiques d'un conjunt de cases, atributs que les descriuen molt en detall i on l'objectiu principal és poder arribar a fer regressió del preu de venda d'aquestes cases. Per tant estaríem davant d'un problema paramètric, on a priori es podríen aplicar mètodes supervisats.

En el dataset Hi ha 1460 obs.amb 81 atributs, on la variable a predir és contínua (SalePrice). S'identifiquen inicialment els atributs numèrics que poden ser d'interès per l'estimació del preu de la casa.

Identificació atributs numèrics:

OverallQual: Rates the overall material and finish of the house

       10	Very Excellent
       9	Excellent
       8	Very Good
       7	Good
       6	Above Average
       5	Average
       4	Below Average
       3	Fair
       2	Poor
       1	Very Poor

OverallCond: Rates the overall condition of the house

       10	Very Excellent
       9	Excellent
       8	Very Good
       7	Good
       6	Above Average	
       5	Average
       4	Below Average	
       3	Fair
       2	Poor
       1	Very Poor
       
YearBuilt: Original construction date
YearRemodAdd: Remodel date (same as construction date if no remodeling or additions)
MasVnrArea: Masonry veneer area in square feet
BsmtFinSF1: Type 1 finished square feet
BsmtFinSF2: Type 2 finished square feet
BsmtUnfSF: Unfinished square feet of basement area
# --BsmtUnfSF: Unfinished square feet of basement area
TotalBsmtSF: Total square feet of basement area
1stFlrSF: First Floor square feet
2ndFlrSF: Second floor square feet
LowQualFinSF: Low quality finished square feet (all floors)
GrLivArea: Above grade (ground) living area square feet
BsmtFullBath: Basement full bathrooms
#-- BsmtHalfBath: Basement half bathrooms
FullBath: Full bathrooms above grade
# --HalfBath: Half baths above grade
TotRmsAbvGrd: Total rooms above grade (does not include bathrooms)
Bedroom: Bedrooms above grade (does NOT include basement bedrooms)
Kitchen: Kitchens above grade
Fireplaces: Number of fireplaces
GarageYrBlt: Year garage was built
GarageCars: Size of garage in car capacity
GarageArea: Size of garage in square feet
WoodDeckSF: Wood deck area in square feet
OpenPorchSF: Open porch area in square feet
EnclosedPorch: Enclosed porch area in square feet
3SsnPorch: Three season porch area in square feet
ScreenPorch: Screen porch area in square feet
PoolArea: Pool area in square feet
MiscVal: $Value of miscellaneous feature
#--MoSold: Month Sold (MM)
YrSold: Year Sold (YYYY)


A continuació, llistem també els atributs categòrics que poden influir en el preu:

MSSubClass: Identifies the type of dwelling involved in the sale.	

        20	1-STORY 1946 & NEWER ALL STYLES
        30	1-STORY 1945 & OLDER
        40	1-STORY W/FINISHED ATTIC ALL AGES
        45	1-1/2 STORY - UNFINISHED ALL AGES
        50	1-1/2 STORY FINISHED ALL AGES
        60	2-STORY 1946 & NEWER
        70	2-STORY 1945 & OLDER
        75	2-1/2 STORY ALL AGES
        80	SPLIT OR MULTI-LEVEL
        85	SPLIT FOYER
        90	DUPLEX - ALL STYLES AND AGES
       120	1-STORY PUD (Planned Unit Development) - 1946 & NEWER
       150	1-1/2 STORY PUD - ALL AGES
       160	2-STORY PUD - 1946 & NEWER
       180	PUD - MULTILEVEL - INCL SPLIT LEV/FOYER
       190	2 FAMILY CONVERSION - ALL STYLES AND AGES

MSZoning: Identifies the general zoning classification of the sale.
		
       A	Agriculture
       C	Commercial
       FV	Floating Village Residential
       I	Industrial
       RH	Residential High Density
       RL	Residential Low Density
       RP	Residential Low Density Park 
       RM	Residential Medium Density


Street: Type of road access to property

       Grvl	Gravel	
       Pave	Paved
       	
Alley: Type of alley access to property

       Grvl	Gravel
       Pave	Paved
       NA 	No alley access
		
LotShape: General shape of property

       Reg	Regular	
       IR1	Slightly irregular
       IR2	Moderately Irregular
       IR3	Irregular
       
LandContour: Flatness of the property

       Lvl	Near Flat/Level	
       Bnk	Banked - Quick and significant rise from street grade to building
       HLS	Hillside - Significant slope from side to side
       Low	Depression
		
Utilities: Type of utilities available
		
       AllPub	All public Utilities (E,G,W,& S)	
       NoSewr	Electricity, Gas, and Water (Septic Tank)
       NoSeWa	Electricity and Gas Only
       ELO	Electricity only	
	
LotConfig: Lot configuration

       Inside	Inside lot
       Corner	Corner lot
       CulDSac	Cul-de-sac
       FR2	Frontage on 2 sides of property
       FR3	Frontage on 3 sides of property
	
LandSlope: Slope of property
		
       Gtl	Gentle slope
       Mod	Moderate Slope	
       Sev	Severe Slope
	
Neighborhood: Physical locations within Ames city limits

       Blmngtn	Bloomington Heights
       Blueste	Bluestem
       BrDale	Briardale
       BrkSide	Brookside
       ClearCr	Clear Creek
       CollgCr	College Creek
       Crawfor	Crawford
       Edwards	Edwards
       Gilbert	Gilbert
       IDOTRR	Iowa DOT and Rail Road
       MeadowV	Meadow Village
       Mitchel	Mitchell
       Names	North Ames
       NoRidge	Northridge
       NPkVill	Northpark Villa
       NridgHt	Northridge Heights
       NWAmes	Northwest Ames
       OldTown	Old Town
       SWISU	South & West of Iowa State University
       Sawyer	Sawyer
       SawyerW	Sawyer West
       Somerst	Somerset
       StoneBr	Stone Brook
       Timber	Timberland
       Veenker	Veenker
			
Condition1: Proximity to various conditions
	
       Artery	Adjacent to arterial street
       Feedr	Adjacent to feeder street	
       Norm	Normal	
       RRNn	Within 200' of North-South Railroad
       RRAn	Adjacent to North-South Railroad
       PosN	Near positive off-site feature--park, greenbelt, etc.
       PosA	Adjacent to postive off-site feature
       RRNe	Within 200' of East-West Railroad
       RRAe	Adjacent to East-West Railroad
	
Condition2: Proximity to various conditions (if more than one is present)
		
       Artery	Adjacent to arterial street
       Feedr	Adjacent to feeder street	
       Norm	Normal	
       RRNn	Within 200' of North-South Railroad
       RRAn	Adjacent to North-South Railroad
       PosN	Near positive off-site feature--park, greenbelt, etc.
       PosA	Adjacent to postive off-site feature
       RRNe	Within 200' of East-West Railroad
       RRAe	Adjacent to East-West Railroad
	
BldgType: Type of dwelling
		
       1Fam	Single-family Detached	
       2FmCon	Two-family Conversion; originally built as one-family dwelling
       Duplx	Duplex
       TwnhsE	Townhouse End Unit
       TwnhsI	Townhouse Inside Unit
	
HouseStyle: Style of dwelling
	
       1Story	One story
       1.5Fin	One and one-half story: 2nd level finished
       1.5Unf	One and one-half story: 2nd level unfinished
       2Story	Two story
       2.5Fin	Two and one-half story: 2nd level finished
       2.5Unf	Two and one-half story: 2nd level unfinished
       SFoyer	Split Foyer
       SLvl	Split Level

RoofStyle: Type of roof

       Flat	Flat
       Gable	Gable
       Gambrel	Gabrel (Barn)
       Hip	Hip
       Mansard	Mansard
       Shed	Shed
		
RoofMatl: Roof material

       ClyTile	Clay or Tile
       CompShg	Standard (Composite) Shingle
       Membran	Membrane
       Metal	Metal
       Roll	Roll
       Tar&Grv	Gravel & Tar
       WdShake	Wood Shakes
       WdShngl	Wood Shingles
		
Exterior1st: Exterior covering on house

       AsbShng	Asbestos Shingles
       AsphShn	Asphalt Shingles
       BrkComm	Brick Common
       BrkFace	Brick Face
       CBlock	Cinder Block
       CemntBd	Cement Board
       HdBoard	Hard Board
       ImStucc	Imitation Stucco
       MetalSd	Metal Siding
       Other	Other
       Plywood	Plywood
       PreCast	PreCast	
       Stone	Stone
       Stucco	Stucco
       VinylSd	Vinyl Siding
       Wd Sdng	Wood Siding
       WdShing	Wood Shingles
	
Exterior2nd: Exterior covering on house (if more than one material)

       AsbShng	Asbestos Shingles
       AsphShn	Asphalt Shingles
       BrkComm	Brick Common
       BrkFace	Brick Face
       CBlock	Cinder Block
       CemntBd	Cement Board
       HdBoard	Hard Board
       ImStucc	Imitation Stucco
       MetalSd	Metal Siding
       Other	Other
       Plywood	Plywood
       PreCast	PreCast
       Stone	Stone
       Stucco	Stucco
       VinylSd	Vinyl Siding
       Wd Sdng	Wood Siding
       WdShing	Wood Shingles
	
MasVnrType: Masonry veneer type

       BrkCmn	Brick Common
       BrkFace	Brick Face
       CBlock	Cinder Block
       None	None
       Stone	Stone

ExterQual: Evaluates the quality of the material on the exterior 
		
       Ex	Excellent
       Gd	Good
       TA	Average/Typical
       Fa	Fair
       Po	Poor
		
ExterCond: Evaluates the present condition of the material on the exterior
		
       Ex	Excellent
       Gd	Good
       TA	Average/Typical
       Fa	Fair
       Po	Poor
		
Foundation: Type of foundation
		
       BrkTil	Brick & Tile
       CBlock	Cinder Block
       PConc	Poured Contrete	
       Slab	Slab
       Stone	Stone
       Wood	Wood
		
BsmtQual: Evaluates the height of the basement

       Ex	Excellent (100+ inches)	
       Gd	Good (90-99 inches)
       TA	Typical (80-89 inches)
       Fa	Fair (70-79 inches)
       Po	Poor (<70 inches
       NA	No Basement
		
BsmtCond: Evaluates the general condition of the basement

       Ex	Excellent
       Gd	Good
       TA	Typical - slight dampness allowed
       Fa	Fair - dampness or some cracking or settling
       Po	Poor - Severe cracking, settling, or wetness
       NA	No Basement
	
BsmtExposure: Refers to walkout or garden level walls

       Gd	Good Exposure
       Av	Average Exposure (split levels or foyers typically score average or above)	
       Mn	Mimimum Exposure
       No	No Exposure
       NA	No Basement
	
BsmtFinType1: Rating of basement finished area

       GLQ	Good Living Quarters
       ALQ	Average Living Quarters
       BLQ	Below Average Living Quarters	
       Rec	Average Rec Room
       LwQ	Low Quality
       Unf	Unfinshed
       NA	No Basement

BsmtFinType2: Rating of basement finished area (if multiple types)

       GLQ	Good Living Quarters
       ALQ	Average Living Quarters
       BLQ	Below Average Living Quarters	
       Rec	Average Rec Room
       LwQ	Low Quality
       Unf	Unfinshed
       NA	No Basement

Heating: Type of heating
		
       Floor	Floor Furnace
       GasA	Gas forced warm air furnace
       GasW	Gas hot water or steam heat
       Grav	Gravity furnace	
       OthW	Hot water or steam heat other than gas
       Wall	Wall furnace
		
HeatingQC: Heating quality and condition

       Ex	Excellent
       Gd	Good
       TA	Average/Typical
       Fa	Fair
       Po	Poor
		
CentralAir: Central air conditioning

       N	No
       Y	Yes
		
Electrical: Electrical system

       SBrkr	Standard Circuit Breakers & Romex
       FuseA	Fuse Box over 60 AMP and all Romex wiring (Average)	
       FuseF	60 AMP Fuse Box and mostly Romex wiring (Fair)
       FuseP	60 AMP Fuse Box and mostly knob & tube wiring (poor)
       Mix	Mixed
		
KitchenQual: Kitchen quality

       Ex	Excellent
       Gd	Good
       TA	Typical/Average
       Fa	Fair
       Po	Poor
       	

Functional: Home functionality (Assume typical unless deductions are warranted)

       Typ	Typical Functionality
       Min1	Minor Deductions 1
       Min2	Minor Deductions 2
       Mod	Moderate Deductions
       Maj1	Major Deductions 1
       Maj2	Major Deductions 2
       Sev	Severely Damaged
       Sal	Salvage only
		
FireplaceQu: Fireplace quality

       Ex	Excellent - Exceptional Masonry Fireplace
       Gd	Good - Masonry Fireplace in main level
       TA	Average - Prefabricated Fireplace in main living area or Masonry Fireplace in basement
       Fa	Fair - Prefabricated Fireplace in basement
       Po	Poor - Ben Franklin Stove
       NA	No Fireplace
		
GarageType: Garage location
		
       2Types	More than one type of garage
       Attchd	Attached to home
       Basment	Basement Garage
       BuiltIn	Built-In (Garage part of house - typically has room above garage)
       CarPort	Car Port
       Detchd	Detached from home
       NA	No Garage
		
GarageFinish: Interior finish of the garage

       Fin	Finished
       RFn	Rough Finished	
       Unf	Unfinished
       NA	No Garage
		
GarageQual: Garage quality

       Ex	Excellent
       Gd	Good
       TA	Typical/Average
       Fa	Fair
       Po	Poor
       NA	No Garage
		
GarageCond: Garage condition

       Ex	Excellent
       Gd	Good
       TA	Typical/Average
       Fa	Fair
       Po	Poor
       NA	No Garage
		
PavedDrive: Paved driveway

       Y	Paved 
       P	Partial Pavement
       N	Dirt/Gravel

PoolQC: Pool quality
		
       Ex	Excellent
       Gd	Good
       TA	Average/Typical
       Fa	Fair
       NA	No Pool
		
Fence: Fence quality
		
       GdPrv	Good Privacy
       MnPrv	Minimum Privacy
       GdWo	Good Wood
       MnWw	Minimum Wood/Wire
       NA	No Fence
	
MiscFeature: Miscellaneous feature not covered in other categories
		
       Elev	Elevator
       Gar2	2nd Garage (if not described in garage section)
       Othr	Other
       Shed	Shed (over 100 SF)
       TenC	Tennis Court
       NA	None

SaleType: Type of sale
		
       WD 	Warranty Deed - Conventional
       CWD	Warranty Deed - Cash
       VWD	Warranty Deed - VA Loan
       New	Home just constructed and sold
       COD	Court Officer Deed/Estate
       Con	Contract 15% Down payment regular terms
       ConLw	Contract Low Down payment and low interest
       ConLI	Contract Low Interest
       ConLD	Contract Low Down
       Oth	Other
		
SaleCondition: Condition of sale

       Normal	Normal Sale
       Abnorml	Abnormal Sale -  trade, foreclosure, short sale
       AdjLand	Adjoining Land Purchase
       Alloca	Allocation - two linked properties with separate deeds, typically condo with a garage unit	
       Family	Sale between family members
       Partial	Home was not completed when last assessed (associated with New Homes)



VALORS NA
==========

Anàlisi dels valors NA en el total d'atributs del dataset de training:

```{r pressure, echo=FALSE}
sapply(train, function(x) sum(is.na(x)))
```

Dels atributs numèrics seleccionats, s'observa que no hi ha valors na, tot i que poden haver-hi 0, per exemple en els anys. En la variable SalePrice tampoc hi ha NA.

En els atributs categòrics sí s'observen valors per NA, en aquest cas, no fence/none, i s'observa que en tots els casos formarien part del domini dels atributs. e.g. significant cap.

Fence: Fence quality
		
       GdPrv	Good Privacy
       MnPrv	Minimum Privacy
       GdWo	Good Wood
       MnWw	Minimum Wood/Wire
       NA	No Fence

e.g.
MiscFeature: Miscellaneous feature not covered in other categories
		
       Elev	Elevator
       Gar2	2nd Garage (if not described in garage section)
       Othr	Other
       Shed	Shed (over 100 SF)
       TenC	Tennis Court
       NA	None


GarageType:81 NA Garage location 81, el quan indica que l'any del garatge no pot omplir-se perquè no hi ha garatge. --GarageYrBlt: Year garage was built
		
       2Types	More than one type of garage
       Attchd	Attached to home
       Basment	Basement Garage
       BuiltIn	Built-In (Garage part of house - typically has room above garage)
       CarPort	Car Port
       Detchd	Detached from home
       NA	No Garage
		

REDUCCIO DE DIMENSIONALITAT
===========================

Donat que es té una gran quantitat d'atributs: 81 atributs es fa una reducció de la dimensionalitat.
1-Donat que tenim 1460 observacions, es prescindeix dels atributs amb un nombre molt elevat de NA. (where NA >1000 NA) --> Alley, PoolQC, Fence, MiscFeature

```{r pressure, echo=FALSE}
train = subset(train, select = -c(Alley,PoolQC,Fence,MiscFeature) )
```
2- Abans de fer matrius de correlació per a identificar i prescidir d'atributs amb una alta correlació entre ells (colinealitat) o amb molt poca correlació amb la variable Sale Price, es fa una prova de normalitat i homoscedasticitat.

2-1-Normalitat de Sale Price que és la variable dependent.

Histograma: Per a veure les frequêncies. Es divideix per 1000 per a fer llegibles els preus. Els preus més freqüents estan entre 100k i 200k
```{r pressure, echo=FALSE}
hist(train$SalePrice/1000, main="Sale Price")
```

Visualment no sembla seguir una distribució normal
```{r pressure, echo=FALSE}
qqnorm(train$SalePrice, main="SalePrice") 
qqline(train$SalePrice,col=2)
```

Es confirma la manca de normalitat amb els tests de Kolmogorov-Smirnov i Shapiro-Wilk.
```{r pressure, echo=FALSE}
ks.test(train$SalePrice, pnorm, mean(train$SalePrice), sd(train$SalePrice))
```

```{r pressure, echo=FALSE}
shapiro.test(train$SalePrice)
```
veiem com el p-value és < 0.05, el qual vol dir que la Hipòtesi 0 no és cumpleix i per tant podem confirmar que hi ha un manca de normalitat.


2-2- A continuació es fa la prova de normalitat de les variables numèriques usant el mètode de Shapiro-Wilk:

```{r pressure, echo=FALSE}
library(nortest)
train <- as.data.frame(train)
##---- **** encara no funciona!
alpha = 0.05 
col.names = colnames(train)
for (i in 1:ncol(train)) { 
        if (i == 1) cat("Variables que no segueixen una distribució normal:\n") 
        
        if (is.integer(train[,i]) | is.numeric(train[,i])) { 
                
               #p_val = ad.test(train[,i])$p.value
                p_val = shapiro.test(train[,i])$p.value 
                #  print(col.names[i])
               # print (p_val)
                if (p_val < alpha) {
                        cat (paste("No Normal: --> ", col.names[i]),"\r\n")
# Format output if (i < ncol(automoviles) - 1) cat(", ") if (i %% 3 == 0) cat("\n")
                }
               else{
                       cat (paste("Normal: --> ", col.names[i]),"\r\n")
               }
               
        }
                
} 
```

Per tant sembla que cap de les variables numèriques no segueix una distribució normal.

2-3- Tot seguit, comprovem la correlació entre els diferents atributs numèrics respecte a l'atribut SalePrice, aplicant la funció cor() que genera una matriu amb els percentatges de correlació entre les variables seleccionades.

```{r pressure, echo=FALSE}
cor(train[,c('OverallQual','OverallCond','YearBuilt','YearRemodAdd','MasVnrArea','BsmtFinSF1','BsmtFinSF2','BsmtUnfSF','TotalBsmtSF','1stFlrSF','2ndFlrSF','LowQualFinSF','GrLivArea','BsmtFullBath','BsmtHalfBath','FullBath','HalfBath','BedroomAbvGr','KitchenAbvGr','TotRmsAbvGrd','Fireplaces','GarageYrBlt','GarageCars','GarageArea','WoodDeckSF','OpenPorchSF','EnclosedPorch','3SsnPorch','ScreenPorch','PoolArea','MiscVal','MoSold','YrSold','SalePrice')], train['SalePrice'])
```


En aquest cas com els atributs numèrics no segueixen una distribució normal, s'usa Spearman per a fer una matriu de correlació de les variables quantitatives amb la variable Sale Price. Prèviament es normalitzen els valors usant el mètode scale que usa una normalització de tipus z-score.


```{r pressure, echo=FALSE}
train.scaled <- scale(train[,c('OverallQual','OverallCond','YearBuilt','YearRemodAdd','MasVnrArea','BsmtFinSF1','BsmtFinSF2','BsmtUnfSF','TotalBsmtSF','1stFlrSF','2ndFlrSF','LowQualFinSF','GrLivArea','BsmtFullBath','BsmtHalfBath','FullBath','HalfBath','BedroomAbvGr','KitchenAbvGr','TotRmsAbvGrd','Fireplaces','GarageYrBlt','GarageCars','GarageArea','WoodDeckSF','OpenPorchSF','EnclosedPorch','3SsnPorch','ScreenPorch','PoolArea','MiscVal','MoSold','YrSold','SalePrice')])

#es converteix a data frame
train.scaled <- as.data.frame(scale(train.scaled))

```



```{r pressure, echo=FALSE}
corr_matrix <- matrix(nc = 2, nr = 0) 
colnames(corr_matrix) <- c("estimate", "p-value")

for (i in 1:(ncol(train.scaled) - 1)) { 
 if (is.integer(train.scaled[,i]) | is.numeric(train.scaled[,i])) { 
   spearman_test = cor.test(train.scaled[,i],
   train.scaled[,length(train.scaled)], method = "spearman") 
   corr_coef = spearman_test$estimate 
   p_val = spearman_test$p.value
# Add row to matrix 
   pair = matrix(ncol = 2, nrow = 1) 
   pair[1][1] = corr_coef 
   pair[2][1] = p_val 
   corr_matrix <- rbind(corr_matrix, pair) 
   rownames(corr_matrix)[nrow(corr_matrix)] <- colnames(train.scaled)[i]
  }
}
print(corr_matrix)

```


Les variables més fortament correlacionades, observades amb valors estimats més alts són:

OverallQual: Rates the overall material and finish of the house
GrLivArea: Above grade (ground) living area square feet
YearBuilt: Original construction date
GarageCars: Size of garage in car capacity
GarageArea: Size of garage in square feet


Les variables menys interessants són les que tenen una estimació més a prop de 0. Per tal de reduir la dimensionalitat es pot prescindir de les variables entre -0.2 i 0.2 que no tindrien massa correlació amb el Sale Price:

OverallCond
BsmtFinSF2
BsmtUnfSF
LowQualFinSF
BsmtHalfBath
KitchenAbvGr
3SsnPorch
ScreenPorch
PoolArea
MiscVal       
MoSold
YrSold

```{r pressure, echo=FALSE}
train = subset(train, select = -c(OverallCond,BsmtFinSF2,BsmtUnfSF,LowQualFinSF,
BsmtHalfBath,BsmtHalfBath,KitchenAbvGr,`3SsnPorch`,ScreenPorch,PoolArea,
MiscVal,MoSold,YrSold) )
```


Tractament d'outliers
======================

IDENTIFICACIÓ:

1-Variable de classe-dependent: Sale Price

```{r pressure, echo=FALSE}
summary(train$SalePrice)
```

```{r pressure, echo=FALSE}
boxplot.stats(train$SalePrice)$out
```

Observem com la majoria d'outliers són preus alts comparats amb la mitja que és de 163000. 


2-Variables independents:

Probablement cases del segle passat.

```{r pressure, echo=FALSE}
boxplot.stats(train$YearBuilt)$out
```

```{r pressure, echo=FALSE}
bp <-boxplot(train$BsmtFinSF1,main="Type 1 finished square feet") 
bp$out
#boxplot.stats(train$BsmtFinSF1)$out
```


```{r pressure, echo=FALSE}
boxplot.stats(train$TotalBsmtSF)$out
```
Hi ha o un total de metres quadrats de la basement area (sotano) molt gran > 2000 o bé 0


```{r pressure, echo=FALSE}
boxplot.stats(train$`1stFlrSF`)$out
```

```{r pressure, echo=FALSE}
boxplot.stats(train$`2ndFlrSF`)$out
```

(.....)

TRACTAMENT d'OUTLIERS:
analitzar quin mètode aplicar (KNN, missforest, o més simples com mean, etc) o si té sentit deixar els valors perquè no es detecta cap error, sinó que són valors reals.

```{r pressure, echo=FALSE}
a
```






CREACIÓ DE NOVES VARIABLES NUMÈRIQUES A PARTIR DE LES CATEGÒRIQUES
===================================================================
*semblant aL que es fa al tutorial: Fun with Real Estate Data (Tutorial)
https://www.kaggle.com/skirmer/fun-with-real-estate-data
Donat que la variable de classe Sales Price és una variable contínua, es vol aproximar la relació de dependència lineal entre Sales Price i la resta de variables independents. 
A partir d'aquests camps categòrics es creen nous camps numèrics. Per nomenclatura comencen per vn (versió numèrica)
LotShape
```{r pressure, echo=FALSE}
train$vnLotShape[train$LotShape == "IR3"] <- 1
train$vnLotShape[train$LotShape == "IR2"] <- 2
train$vnLotShape[train$LotShape == "IR1"] <- 3
train$vnLotShape[train$LotShape == "Reg"] <- 4
```
```{r pressure, echo=FALSE}
a
```
PREGUNTES
==========
PRINCIPAL segons competició de Kaggle: Predicció de vendes de les cases en el dataset de test, enviant un fitxer amb el id de casa i el preu de venda predit
1-Quina és la predicció de vendes en el data set de test?
2-Influeix més els squares meters o l'any de construcció sobre el preu? (Comparació de grups independents)
3- Es el barri (neighbourhood) determinant en el preu de les cases.
ESBORRANY
==========
Para fer agrupacions per un atribut i veure les vendes, e.g.
```{r pressure, echo=FALSE}
housestyle_price <- summarize(group_by(train, HouseStyle),
          mean(SalePrice, na.rm=T))
housestyle_price
```
```{r pressure, echo=FALSE}
table(train$Street)
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
```{r pressure, echo=FALSE}
a
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
WEBGRAPHY
==========
HousePrices - kaggle
https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview
HousePrices - kaggle - Tutorials
https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview/tutorials
HousePrices - Kaggle - Start Here - Visualization and Model Stacking
https://www.kaggle.com/rp1611/start-here-visualization-and-model-stacking
Trabajo de Fin de Grado - ESTUDIO DE TÉCNICAS SUPERVISADAS DE REDUCCIÓN
DE DIMENSIONALIDAD PARA PROBLEMAS DE CLASIFICACIÓN - Álvaro Soriano Maganto  2016-2017
https://e-archivo.uc3m.es/bitstream/handle/10016/26504/TFG_Alvaro_Soriano_Maganto.pdf
The most common dimension techniques - RPubs
https://rpubs.com/Saskia/520216
Análisis de Regresión - Alfonso Novales - Departamente de Economía Cuantitativa 2010
https://www.ucm.es/data/cont/docs/518-2013-11-13-Analisis%20de%20Regresion.pdf